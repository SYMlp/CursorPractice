# 项目更新记录

## 2024-07-16 11:45:32
- 修复了南丁格尔玫瑰图组件的数据处理问题
- 增强了数据验证逻辑，确保name和value属性有效
- 针对null或undefined数据提供了默认值处理
- 添加了错误捕获和日志记录，提高组件稳定性
- 优化了generateAlarmTypeData函数的数据生成逻辑
- 增加了数据加载状态的调试日志输出

## 2024-07-16 11:28:45
- 将DonutChart组件升级为支持南丁格尔玫瑰图
- 添加roseType属性，支持"radius"和"area"两种南丁格尔玫瑰图模式
- 默认使用"area"模式，展示效果更加明显
- 调整了默认内圆半径为0.1，更适合南丁格尔玫瑰图展示
- 添加了边框宽度和边框颜色配置选项
- 优化了告警类型分布图表，应用南丁格尔玫瑰图样式

## 2024-07-16 10:15:26
- 美化优化了DonutChart组件
- 调整了DonutChart默认参数：内圆半径缩小(0.35)，外圆半径扩大(0.8)
- 默认标签位置改为外部显示(outside)，并同时显示名称和百分比
- 默认图例位置改为底部(bottom)，提供更好的布局
- 优化了标签折线样式，增加了平滑效果和适当的长度
- 添加了标签文本的富文本样式设置，使其更清晰美观
- 默认添加了微小的扇区间隙角度(0.02)和圆角效果(3)

## 2024-07-15 23:15:32
- 美化优化了告警类型分布图表的展示效果
- 从行业分布统计调整回告警类型分布
- 扩大了环形图显示尺寸
- 优化了标签显示，将文字百分比显示在折线上
- 调整了图表颜色方案，使用更鲜明的对比色
- 微调了环形图的间距和圆角参数

## 2024-07-15 22:43:15
- 优化了AssetMonitoring页面的图表展示
- 将告警类型分布图表替换为行业分布统计图表
- 优化了DonutChart的配色和展示效果
- 调整了图表标题和参数配置

## 2024-06-16 19:27:13
- 修复资产访问关系图显示问题
- 使用固定示例数据确保图表正确渲染
- 优化节点和边的样式及布局
- 确保所有连接线正确显示

## 2024-06-15 21:34:28
优化了 AssetFlowChart 组件的数据处理逻辑：
1. 使用 useMemo 确保初始节点和边的数据在组件重新渲染时不会被重置
2. 改进了 useEffect 中的条件判断，使用 Array.isArray() 替代长度检查
3. 添加了日志输出，方便调试组件状态和数据更新
4. 优化了组件在不同渲染状态下的性能和稳定性

## 2024-06-15 21:51:16

1. 优化了`AssetFlowChart`组件，增加了以下功能：
   - 添加了节点和边的点击交互功能
   - 实现了节点和连接详情的信息展示面板
   - 增强了图表渲染效果，添加了动画和样式
   - 优化了空数据状态的显示
   - 增加了控制台日志记录，方便调试
   - 将组件重构为包含ReactFlowProvider的架构，提高稳定性

2. 与ResourceFlowChart组件功能保持一致，确保用户体验的一致性

## 2024-07-22：告警类型分布图实现总结

1. 告警类型分布图使用了EnhancedDonutChart组件实现，是一个基于ECharts的环形图组件
2. 组件主要特点：
   - 简洁美观的环形设计，使用40%-70%的半径比例
   - 外部标签配合引导线，清晰展示各类型名称和数值
   - 扇区圆角效果(borderRadius: 7)和边框(borderWidth: 2)增强视觉效果
   - 中心显示"告警事件数"标题和总计数值
   - 使用明亮友好的配色方案，包括红色、紫色、绿色等七种预定义颜色
   - 支持数据归一化处理，显示原始数值和百分比
3. 实现了交互功能：鼠标悬停显示详细信息，点击可触发回调函数
4. 在AssetMonitoring页面中集成了该组件，支持不同时间范围的数据展示
5. 组件支持自适应容器高度，通过fitContainer属性控制
6. 完成时间：2024-07-22 16:30:45 

## 2024-07-22 17:25:30：优化资产访问关系图

1. 重新设计了资产访问关系图的数据模型和布局，使其更加符合产品设计图
2. 优化了节点颜色配置：蓝色表示应用系统、绿色表示用户、红色表示告警事件
3. 改进了图表交互功能，增加了MiniMap和图例面板，提高用户体验
4. 重构了连线数据模型，区分不同类型连接：
   - 蓝色实线：用户与应用之间的正常访问关系
   - 红色实线：用户与告警之间的风险关联
   - 红色虚线：应用与告警之间的告警关联
5. 增强了细节信息面板，以列表形式展示连接的详细数据
6. 美化了节点样式，添加悬停效果和过渡动画 

## 2024-07-22：通知组件和通知服务实现总结

### 通知组件（Notification）
- 创建了一个通用的通知组件 `Notification`，支持四种类型的通知：成功（success）、警告（warning）、错误（error）和信息（info）
- 实现了自定义样式，每种通知类型具有独特的图标和颜色
- 添加了以下功能：
  - 自动关闭计时器：可配置显示时长，默认为3000毫秒
  - 可手动关闭功能：提供关闭按钮，点击可立即关闭通知
  - 动画效果：淡入淡出动画，增强用户体验
  - 标题和消息内容：支持显示标题和详细信息
  - 组件位置：默认显示在右上角，不妨碍用户操作界面

### 通知服务（NotificationService）
- 创建了全局通知服务 `NotificationService`，支持在应用任何位置触发通知
- 提供了两种使用方式：
  - 服务式API：直接调用 `notificationService.success()`、`notificationService.error()` 等方法
  - React Hook方式：使用 `useNotification()` hook在React组件内触发通知
- 基于React Context实现，通过 `NotificationProvider` 在应用根级别提供状态管理
- 添加了 `GlobalNotificationListener` 组件，支持非React环境（如工具函数、API响应处理等）触发通知
- 创建了示例组件 `NotificationServiceExample`，展示各种通知类型的实际效果和用法

### 集成和配置
- 在App组件中集成了通知服务，使其在整个应用中可用
- 添加了通知组件示例页面，可通过侧边栏导航访问
- 更新了菜单导航结构，使用更现代化的侧边菜单替代顶部菜单

记录时间：2024-07-22 14:42:30 

## 2024-07-23：优化数据资产防护监测页面

1. 提取和重用多个通用组件，提高代码复用性和可维护性：
   - StatisticCard: 用于展示各类统计指标
   - RankingCard: 可复用的排行榜卡片组件
   - ResourceFlowLegend: 资源流程图的图例组件
   - DetailPanel: 通用的详情面板组件

2. 增强页面交互功能：
   - 为资源流程图添加节点和边的点击事件处理
   - 增加选中节点/边的详细信息展示
   - 实现排行榜项的点击事件

3. 优化页面布局与视觉效果：
   - 优化统计卡片样式，使用更现代的浅灰色背景
   - 统一排行榜卡片的样式和交互效果
   - 遵循图片参考中的布局设计，保持左右上下分区的结构
   - 美化节点详情面板的展示

4. 代码结构优化：
   - 使用React Hooks管理组件状态
   - 使用TypeScript类型增强代码安全性
   - 优化组件属性传递，增强代码可读性和可维护性
   - 使用模块化导出，便于后续扩展

记录时间：2024-07-23 2024-07-23 15:32:45 

## 2024-07-23：组件重构 - DetailPanel移动到cards目录

1. 将DetailPanel组件从`/components/DetailPanel.tsx`迁移到`/components/cards/DetailPanel.tsx`
2. 优化了组件的代码结构和类型定义
3. 更新了`/components/cards/README.md`，添加了DetailPanel组件的使用说明和示例代码
4. 重构目的：
   - 将所有卡片类组件统一放置在cards目录下，提高代码组织结构的清晰度
   - 确保相似功能的组件放在同一目录，方便后续维护和扩展
   - 使组件分类更加合理，便于开发者查找和使用

记录时间：2024-07-23 2024-07-23 15:32:45 

## 2024-07-24：优化数据资产防护监测页面的访问关系图

1. 将节点/边详情面板集成到ResourceFlowChart组件内部
   - 原来的实现在DataAssetMonitoring页面上通过状态管理来显示节点详情
   - 新的实现直接在ResourceFlowChart组件内部处理节点选择和详情显示
   - 详情面板直接显示在图表右下角，更接近于交互源

2. 优化代码结构和交互体验：
   - 减少了组件间的状态传递，简化了DataAssetMonitoring组件
   - 提高了组件的内聚性，ResourceFlowChart现在包含完整的交互功能
   - 使用绝对定位将详情面板覆盖在图表上，而不是占用额外空间
   - 增强了本地化显示，将键名翻译为中文（如"访问频率"，"风险等级"等）

3. 改进后的优势：
   - 更好的组件封装，提高了复用性
   - 简化了页面结构，消除了冗余代码
   - 更符合直觉的用户体验，节点详情就在用户点击的位置附近
   - 更高效的实现，减少了数据传递和状态管理的复杂性

记录时间：2024-07-24 2024-07-24 15:32:45 

## 2024-07-24：优化数据资产监测页面中的TOP排行榜组件

1. 改进了RankingCard组件的显示和交互：
   - 将固定的"总计21个"改为显示真实数据条数
   - 将"更多"链接改为按钮样式，提高可见性和可点击性
   - 增加了弹窗(Modal)功能，点击"更多"时展示完整数据列表
   - 优化了弹窗中的表格展示，包括排名、名称、数值和标签信息

2. 弹窗表格功能增强：
   - 自动检测并显示访问量字段
   - 优化标签展示，支持多标签和单标签的不同展示方式
   - 保留了行点击交互，便于查看详情
   - 支持表格内容的滚动，确保大量数据时的良好体验

3. 组件接口优化：
   - 可通过onMoreClick自定义"更多"按钮行为，或使用默认弹窗
   - 支持使用真实数据长度或自定义totalCount显示总数
   - 保持了与原组件的完全兼容性

记录时间：2024-07-24 2024-07-24 15:32:45 

## 2024-07-25：新增表格式排行榜组件(TableTopCard)

1. 新增TableTopCard组件
   - 支持表格式布局，更符合设计图效果
   - 可自定义表头，提高信息展示的清晰度
   - 支持条形图展示，直观显示数据对比关系
   - 支持序号加粗显示，前三名特殊标记
   - 保留了弹窗功能，点击"更多"可查看全部数据

2. 组件特点：
   - 基于React和TypeScript开发，类型安全
   - 使用Tailwind CSS实现样式，保持与项目风格一致
   - 支持进度条可视化数据大小，增强数据感知
   - 支持自定义渲染内容，适应复杂展示需求
   - 设计优雅，响应式布局

3. 数据资产防护监测页面优化：
   - 替换原有的RankingCard组件为新的TableTopCard
   - 存储风险资源TOP组件采用"资源名称"和"风险"两列表头
   - 防护能力缺失TOP组件采用"资源名称"和"防护能力"表头
   - 高敏数据使用风险人员TOP采用"姓名"和"威胁数"表头
   - 创建新的更丰富数据模型，支持新组件多维度数据展示

4. 数据模型优化：
   - 创建新的tableTopData.ts文件，组织表格相关数据
   - 丰富了高风险用户信息，增加部门、威胁类型等属性
   - 存储风险数据新增访问量、风险级别等维度
   - 防护能力数据新增防护等级信息
   - 提供15+条数据记录，支持完整的弹窗展示功能

记录时间：2024-07-25 2024-07-25 15:32:45 

## 2024-07-22：布局组件优化和示例实现

1. 创建了`ContentLayout`组件，用于内容区域的布局组织
   - 支持设置标题、副标题和额外操作区域
   - 提供了清晰的内容分区，增强可读性
   - 位置：`/components/layout/ContentLayout.tsx`

2. 创建了布局组件使用示例`LayoutExample` 
   - 展示了`MainLayout`和`ContentLayout`的组合使用方式
   - 包含多种布局场景示例：基础信息卡片、带操作区域的内容块、活动列表、全宽内容区域
   - 位置：`/components/examples/LayoutExample.tsx`
   - 时间：2024-07-22 15:32:45 

## 2024-07-22：资源访问关系图(ResourceFlowChart)组件分析

ResourceFlowChart是一个基于ReactFlow库实现的复杂资源关系可视化组件，用于展示数据资产、服务、应用、任务和人员之间的访问关系和风险情况。

主要特点：
- 基于ReactFlow库，提供完整的流程图交互功能
- 使用自定义节点类型，包括资源(ResourceNode)、服务(ServiceNode)、应用(ApplicationNode)、任务(TaskNode)和人员(PersonNode)
- 节点数据包含标签、访问次数、访问频率、风险级别、风险评分和描述信息
- 连线数据包含访问频率、访问次数、最后访问时间、风险级别和风险评分
- 根据风险级别自动设置不同的连线颜色（红色=极高风险，橙色=高风险，黄色=中风险，绿色=低风险）
- 支持节点和连线的点击事件，点击后在右下角展示详细信息面板
- 组件已集成到数据资产监测页面(DataAssetMonitoring)，与ResourceFlowLegend组件配合使用

后续优化方向：
- 支持动态数据加载和更新
- 增加时间筛选功能，展示不同时间段的资源访问关系
- 优化布局算法，使节点分布更加清晰合理
- 增加缩放和拖拽功能，提升大规模数据下的可视化体验

当前时间：2024-07-22 ${new Date().toLocaleString('zh-CN')} 

## 2023年5月15日更新记录

### 添加资源流程图模拟数据

创建时间: 2023-05-15 15:57:32

1. 在 `data/mock/network` 目录下创建了资源流程图的模拟数据
2. 新增 `resourceFlowData.ts` 文件，包含完整的节点和边数据结构及示例数据
3. 新增 `README.md` 文件，说明数据结构和使用方法
4. 新增 `index.ts` 文件，统一导出所有网络关系图模拟数据

该模拟数据可用于以下场景：
- 资源流程图组件的开发和测试
- 安全风险可视化展示
- 异常连接场景模拟

相关文件：
- `security-dashboard/src/data/mock/network/resourceFlowData.ts`
- `security-dashboard/src/data/mock/network/README.md`
- `security-dashboard/src/data/mock/network/index.ts` 

## 2024-07-23：修复ResourceFlowChart组件中的类型导入问题
1. 修复ResourceFlowChart组件无法导入resourceFlowData.ts的问题
2. 将原来从外部导入的枚举和接口定义改为内联定义，消除外部依赖
3. 确保DetailPanel组件中的value属性正确转换为字符串类型
4. 完成时间：2024-07-23 ${new Date().toLocaleString('zh-CN')} 

## 2024-07-23：在数据资产防护监测页面实现资源访问关系图
1. 优化了数据资产防护监测页面中的资源访问关系图展示
2. 接入了完整的 resourceFlowData 模拟数据源，使用包含异常连接的数据集
3. 为 ResourceFlowChart 组件传入初始节点和边的数据
4. 启用了控件显示和自动适应视图，提升用户体验
5. 资源关系图现在可以展示：
   - 资源节点与服务节点的连接
   - 服务节点与应用节点的连接
   - 应用节点与任务节点的连接
   - 任务节点与人员节点的连接
   - 包含一条异常连接：从人员直接到资源
6. 保留了节点和边的点击功能，点击后会在图表右下角显示详细信息
7. 完成时间：2024-07-23 ${new Date().toLocaleString('zh-CN')} 