# 节点组件 (Nodes)

## 组件概述

本目录包含用于流程图和关系图的自定义节点组件，基于ReactFlow库实现。这些组件主要用于资源流程图、资产关系图等网络拓扑图的节点展示。作为networks目录的子组件，它们专门服务于网络图表组件。

## 组件列表

| 组件名称 | 文件 | 描述 |
|---------|------|------|
| ResourceNode | ResourceNode.tsx | 资源节点，用于展示数据资源，带有风险评分和风险等级 |
| ServiceNode | ServiceNode.tsx | 服务节点，用于展示微服务或后端服务，带有风险评分和风险等级 |
| ApplicationNode | ApplicationNode.tsx | 应用节点，用于展示业务应用，带有风险评分和风险等级 |
| TaskNode | TaskNode.tsx | 任务节点，用于展示业务任务或流程，带有风险评分和风险等级 |
| PersonNode | PersonNode.tsx | 人员节点，用于展示用户或操作人员，带有风险评分和风险等级 |

## 样式与主题

所有节点组件共享 `nodes.css` 文件中定义的样式，包括：

- 基础节点样式（边框、阴影、圆角等）
- 节点内容布局（标题、标签、风险信息等）
- 不同类型节点的颜色主题：
  - ResourceNode: 蓝色主题
  - ServiceNode: 绿色主题
  - ApplicationNode: 紫色主题
  - TaskNode: 橙色主题
  - PersonNode: 深蓝色主题

## 使用场景

这些节点组件主要在以下场景中使用：

1. **ResourceFlowChart**: 在数据资产监控页面中展示资源访问关系
2. ~~**AssetFlowChart**: 在应用资产监控页面中展示应用、用户和告警的关系~~

> **注意**: 目前 AssetFlowChart 组件并未使用该目录下的节点组件，而是使用了内部定义的 AssetNode 组件。这可能导致组件风格不一致，建议统一使用方式。

## 代码规范

每个节点组件遵循以下规范：

1. 使用函数式组件和TypeScript类型定义
2. 包含标准的ReactFlow节点接口，如`Handle`组件用于连接点
3. 接受统一的数据结构，包含label、riskScore、riskLevel等属性
4. 共享相同的CSS类名和样式结构

## 位置合理性评估

### 优点

1. 作为networks目录下的子目录，更明确表示这些组件属于网络图表生态系统
2. 通过index.ts导出所有组件，方便其他文件引用
3. 共享CSS样式，保持视觉一致性
4. 结构清晰，遵循组件化设计原则

### 存在问题

1. **一致性问题**: AssetFlowChart 组件并未使用此目录下的节点组件，而是自定义了AssetNode组件，导致项目中存在两套不同的节点系统
2. **使用场景有限**: 这些组件主要只在ResourceFlowChart中使用，使用范围较窄

### 改进建议

1. 统一节点组件系统，将AssetFlowChart改为使用此目录下的节点组件，或者将AssetNode组件也整合到此目录中
2. 考虑将节点更加通用化，增加配置选项，以适应更多场景
3. 添加更详细的JSDoc注释，提高代码可读性
4. 重构组件以减少代码重复，可以考虑创建一个基础节点组件，其他节点组件继承基础组件
5. 为每个组件添加单元测试

## 总结

通过将节点组件移动到networks目录下，我们改进了代码组织结构，使其更符合组件的功能定位。这些组件现在作为网络图表子组件，更明确地表示了它们的主要用途是服务于网络拓扑图和流程图。然而，仍需解决节点系统不一致的问题，建议进行适当的重构和统一，以提高代码质量和维护性。 